{"version":3,"sources":["../../../public/javascripts/main.js"],"names":["jQuery","document","ready","$","isAnimating","firstLoad","newScaleValue","dashboard","mainContent","loadingBar","on","event","preventDefault","target","sectionTarget","data","hasClass","triggerAnimation","window","newPageArray","location","pathname","split","newPage","length","replace","scrollId","hash","velocity","container","newSection","bool","find","addClass","parent","siblings","children","removeClass","initializeLoadingBar","loadNewContent","section","selectedItem","barHeight","outerHeight","barTop","offset","top","windowHeight","height","maxOffset","scaleValue","toFixed","css","attr","setTimeout","loadingBarAnimation","appendTo","load","scaleMax","scaleY","prev","end","resetAfterAnimation","url","history","pushState","path","remove","resetLoadingBar"],"mappings":"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","file":"main.js","sourcesContent":["jQuery(document).ready(function($){\n\t//set some variables\n\tvar isAnimating = false,\n\t\tfirstLoad = false,\n\t\tnewScaleValue = 1;\n\n\t//cache DOM elements\n\tvar dashboard = $('.cd-side-navigation'),\n\t\tmainContent = $('.cd-main'),\n\t\tloadingBar = $('#cd-loading-bar');\n\n\t//select a new section\n\tdashboard.on('click', 'a', function(event){\n\t\tevent.preventDefault();\n\t\tvar target = $(this),\n\t\t\t//detect which section user has chosen\n\t\t\tsectionTarget = target.data('menu');\n\t\tif( !target.hasClass('selected') && !isAnimating ) {\n\t\t\t//if user has selected a section different from the one alredy visible - load the new content\n\t\t\ttriggerAnimation(sectionTarget, true);\n\t\t}\n\n\t\tfirstLoad = true;\n\t});\n\n\t//detect the 'popstate' event - e.g. user clicking the back button\n  \t$(window).on('popstate', function() {\n\t  \tif( firstLoad ) {\n\t\t    /*\n\t\t    Safari emits a popstate event on page load - check if firstLoad is true before animating\n\t\t    if it's false - the page has just been loaded \n\t\t    */\n\t      \tvar newPageArray = location.pathname.split('/'),\n\t        //this is the url of the page to be loaded \n\t        newPage = newPageArray[newPageArray.length - 1].replace('.html', '');\n\t      \tif( !isAnimating ) triggerAnimation(newPage, false);\n\t    }\n\t    firstLoad = true;\n\t});\n\n  \t//scroll to content if user clicks the .cd-scroll icon\n\tmainContent.on('click', '.cd-scroll', function(event){\n\t\tevent.preventDefault();\n\t\tvar scrollId = $(this.hash);\n\t\t$(scrollId).velocity('scroll', { container: $(\".cd-section\") }, 200);\n\t});\n\n\t//start animation\n\tfunction triggerAnimation(newSection, bool) {\n\t\tisAnimating =  true;\n\t\tnewSection = ( newSection == '' ) ? 'index' : newSection;\n\t\t\n\t\t//update dashboard\n\t\tdashboard.find('*[data-menu=\"'+newSection+'\"]').addClass('selected').parent('li').siblings('li').children('.selected').removeClass('selected');\n\t\t//trigger loading bar animation\n\t\tinitializeLoadingBar(newSection);\n\t\t//load new content\n\t\tloadNewContent(newSection, bool);\n\t}\n\n\tfunction initializeLoadingBar(section) {\n\t\tvar\tselectedItem =  dashboard.find('.selected'),\n\t\t\tbarHeight = selectedItem.outerHeight(),\n\t\t\tbarTop = selectedItem.offset().top,\n\t\t\twindowHeight = $(window).height(),\n\t\t\tmaxOffset = ( barTop + barHeight/2 > windowHeight/2 ) ? barTop : windowHeight- barTop - barHeight,\n\t\t\tscaleValue = ((2*maxOffset+barHeight)/barHeight).toFixed(3)/1 + 0.001;\n\t\t\n\t\t//place the loading bar next to the selected dashboard element\n\t\tloadingBar.data('scale', scaleValue).css({\n\t\t    height: barHeight,\n\t\t    top: barTop\n\t\t}).attr('class', '').addClass('loading '+section);\n\t}\n\n\tfunction loadNewContent(newSection, bool) {\n\t\tsetTimeout(function(){\n\t\t\t//animate loading bar\n\t\t\tloadingBarAnimation();\n\t\t\t\n\t\t\t//create a new section element and insert it into the DOM\n\t\t\tvar section = $('<section class=\"cd-section overflow-hidden '+newSection+'\"></section>').appendTo(mainContent);\n\t\t\t//load the new content from the proper html file\n\t\t\tsection.load(newSection+'.html .cd-section > *', function(event){\n\t\t\t\t//finish up the animation and then make the new section visible\n\t\t\t\tvar scaleMax = loadingBar.data('scale');\n\t\t\t\t\n\t\t\t\tloadingBar.velocity('stop').velocity({\n\t\t\t\t\tscaleY: scaleMax\n\t\t\t\t}, 400, function(){\n\t\t\t\t\t//add the .visible class to the new section element -> it will cover the old one\n\t\t\t\t\tsection.prev('.visible').removeClass('visible').end().addClass('visible').on('webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend', function(){\n\t\t\t\t\t\tresetAfterAnimation(section);\n\t\t\t\t\t});\n\n\t\t\t\t\t//if browser doesn't support transition\n\t\t\t\t\tif( $('.no-csstransitions').length > 0 ) {\n\t\t\t\t\t\tresetAfterAnimation(section);\n\t\t\t\t\t}\n\n\t\t\t\t\tvar url = newSection+'.html';\n\n\t\t\t\t\tif(url!=window.location && bool){\n\t\t\t\t        //add the new page to the window.history\n\t\t\t\t        //if the new page was triggered by a 'popstate' event, don't add it\n\t\t\t\t        window.history.pushState({path: url},'',url);\n\t\t\t\t    }\n\t\t\t\t});\n\t\t\t});\n\n\t\t}, 50);\n\t}\n\n\tfunction loadingBarAnimation() {\n\t\tvar scaleMax = loadingBar.data('scale');\n\t\tif( newScaleValue + 1 < scaleMax) {\n\t\t\tnewScaleValue = newScaleValue + 1;\n\t\t} else if ( newScaleValue + 0.5 < scaleMax ) {\n\t\t\tnewScaleValue = newScaleValue + 0.5;\n\t\t}\n\t\t\n\t\tloadingBar.velocity({\n\t\t\tscaleY: newScaleValue\n\t\t}, 100, loadingBarAnimation);\n\t}\n\n\tfunction resetAfterAnimation(newSection) {\n\t\t//once the new section animation is over, remove the old section and make the new one scrollable\n\t\tnewSection.removeClass('overflow-hidden').prev('.cd-section').remove();\n\t\tisAnimating =  false;\n\t\t//reset your loading bar\n\t\tresetLoadingBar();\n\t}\n\n\tfunction resetLoadingBar() {\n\t\tloadingBar.removeClass('loading').velocity({\n\t\t\tscaleY: 1\n\t\t}, 1);\n\t}\n});"]}